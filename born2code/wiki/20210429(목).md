

## 1. 학습 날짜

* 2021-04-29(목)



## 2. 학습 시간

* 12:00 ~ 17:30 (자가)



## 3. 학습 범위 및 주제

* 리눅스 프로그래밍



## 4. 동료 학습 방법

* 해당 사항 없음



## 5. 학습 목표

* 리눅스 프로그래밍



## 6. 상세 학습 내용

#### 1. chdir

```c
#include <unistd.h>

int chdir(const char* path);
```

* 현재 디렉토리를 변경하는 함수
* 인자
  * path: 변경하려는 새로운 디렉토리 경로
* 반환값
  * 호출 성공시 0 반환
  * 호출 실패시 -1 반환



<hr>

#### 2. getcwd

```c
#include <unistd.h>

char* getcwd(char* buf, size_t size);
```

* 현재 디렉토리 경로를 반환하는 함수
* 인자
  * buf: 반환되는 현재 디렉토리를 저장할 버퍼
  * size: 버퍼의 크기
* 반환값
  * 호출 성공시 buf 의 포인터 반환
  * 호출 실패시 NULL 반환



<hr>

#### 3. 실습 코드

```c
#include <unistd.h>
#include <sys/types.h>
#include <fcntl.h> 
#include <dirent.h> 
#include <stdlib.h> 
#include <stdio.h> 
#include <sys/stat.h> 
#include <string.h> 
#include <errno.h> 

#define BUF_SIZE 256


void nullchk(void *retval, char *errmsg)
{
	if(retval == NULL)
	{
		perror(errmsg);
		exit(1);
	}
}

void errchk(int retval, char *errmsg)
{
	if(retval == -1)
	{
		fprintf(stderr, "%s: %s\n", errmsg, strerror(errno)); 
		exit(1);
	} 
}

int main(void)
{
  int						fd = 0;
  char					buffer[BUF_SIZE] = {0,}; DIR *dirp = NULL;
  struct dirent	*dentry = NULL;
  
  nullchk(getcwd(buffer, BUF_SIZE), "getcwd");
  printf("%s\n", buffer);
  
  errchk(mkdir("apple", 0755), "mkdir apple"); 
  errchk(mkdir("banana", 0755), "mkdir banana");
  errchk(chdir("apple"), "chdir apple");
  
  nullchk(getcwd(buffer, BUF_SIZE), "getcwd");

  printf("%s\n", buffer);
  
  fd = open("test.txt", O_CREAT | O_RDWR, 0644); 
  errchk(fd, "open test.txt");
  errchk(close(fd), "close test.txt");
  
  errchk(chdir(".."), "chdir .."); 
  errchk(rmdir("banana"), "rmdir banana");
  
  dirp = opendir("apple"); 
  nullchk(dirp, "opendir apple");
  while(dentry = readdir(dirp)) 
  	if(dentry->d_ino != 0)
      printf("%s\n", dentry->d_name); 
  
  rewinddir(dirp);
  
  while(dentry = readdir(dirp)) 
  	if(dentry->d_ino != 0)
  		printf("%s\n", dentry->d_name);
  
  errchk(closedir(dirp), "closedir apple");
  return (0); 
 }
```



## 7. 학습 내용에 대한 개인적인 총평

* 리눅스 명령어를 c 파일 안에서 처리하는 게 왠지 신기한 것 같다. 생각해보면 당연히 되는건데 전부터 당연히 안될거라고 생각했어서 그런지 신기하다. 아직까지는 재밌는 것 같다,,
* 이제 정보처리기사가 끝났으니 진짜 ft_server 를 공부해야겠다. cub3D 도 해야하는 건 마찬가지지만 그건 너무 어려워서 ft_server를 먼저 후딱 해버리고 cub3D 를 하는 걸로 해야겠다. 내일은 어차피 클러스터에 가야하니까 내일 이론공부를 하는걸로!



## 8. 다음 학습 계획

* ft_server

